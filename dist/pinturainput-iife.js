/*!
* Pintura Input v9.0.0 
* (c) 2018-2023 PQINA Inc. - All Rights Reserved
* License: https://pqina.nl/pintura/license/
*/
/* eslint-disable */
(function(){"use strict";const L=(e,t,n=[])=>{const s=document.createElement(e),i=Object.getOwnPropertyDescriptors(s.__proto__);for(const r in t)r==="style"?s.style.cssText=t[r]:i[r]&&i[r].set||/textContent|innerHTML/.test(r)||typeof t[r]=="function"?s[r]=t[r]:s.setAttribute(r,t[r]);return n.forEach(r=>s.appendChild(r)),s},D=e=>typeof e=="string";let b=null;const M=()=>(b===null&&(b=typeof window<"u"&&typeof window.document<"u"),b),H=e=>e.charAt(0).toLowerCase()+e.slice(1),N=e=>e.charAt(0).toUpperCase()+e.slice(1),k=e=>H(e.split("-").map(N).join("")),q=e=>typeof e=="object",E=(e,t={},n="",s="")=>Object.keys(t).filter(i=>!q(t[i])).reduce((i,r)=>i.replace(new RegExp(n+r+s),t[r]),e),U=e=>document.createElement(e).constructor!==HTMLElement,B=e=>e instanceof Blob,V=e=>/^image/.test(e.type),W=async e=>new Promise(t=>{if(e.kind==="file")return t(e.getAsFile());e.getAsString(t)}),G=e=>new Promise((t,n)=>{const{items:s}=e.dataTransfer;if(!s)return t([]);Promise.all(Array.from(s).map(W)).then(i=>{t(i.filter(r=>B(r)&&V(r)||/^http/.test(r)))}).catch(n)}),K=(e,t={})=>{const n=i=>{i.preventDefault()},s=async i=>{i.preventDefault(),i.stopPropagation();try{const r=await G(i);e.dispatchEvent(new CustomEvent("dropfiles",{detail:{event:i,resources:r},...t}))}catch{}};return e.addEventListener("drop",s),e.addEventListener("dragover",n),{destroy(){e.removeEventListener("drop",s),e.removeEventListener("dragover",n)}}},R="pintura-input",$="PinturaInput",J=`<output data-process style="display:flex;align-items:center;pointer-events:none;">
    <img src="{url}" alt="" style="object-fit:cover;width:auto;height:1.5em;margin-right:.5em;"/>
    <span>{{success}}</span>
    <button data-remove style="pointer-events:all;margin-left:.5em;" aria-label="Reset">{{reset}}</button>
</output>`,Y=`<div data-load style="display:flex;align-items:center;pointer-events:none;">
    <img src="{{url}}" alt="" style="object-fit:cover;width:auto;height:1.5em;margin-right:.5em;"/>
    <button data-remove style="pointer-events:all;margin-left:.5em;" aria-label="Reset">{{reset}}</button>
</output>`,z=["accept","capture"],Q=(e,t)=>new Promise((n,s)=>{const{store:i,editor:r,eventTarget:c,imageState:u}=t,{openDefaultEditor:p,dispatchEditorEvents:o}=window.pintura,l={};r.imageReader&&(l.imageReader={...r.imageReader}),(r.imageWriter||i)&&(l.imageWriter={store:(D(i),i),...r.imageWriter});const a=p({...l,...X(r,["id","name","store","imageWriter","imageReader"]),src:e,imageState:u}),oe=o(a,c);let x=!1;a.on("loadabort",()=>{a.close(),x=!0}),a.on("loaderror",s),a.on("processerror",s),a.on("close",()=>{oe.forEach(ae=>ae()),x?s():n(void 0)}),a.on("process",n)}),d=(e,t)=>e.getAttribute(t),X=(e,t)=>Object.keys(e).filter(n=>!t.includes(n)).reduce((n,s)=>({...n,[s]:e[s]}),{}),h=e=>{e.value="",/safari/i.test(navigator.userAgent)||(e.type="",e.type="file"),delete e._files},C=(e,t)=>{try{const n=new DataTransfer;n.items.add(t),e.files=n.files}catch{e._files=[t]}},Z=e=>{if(!e||!e.matches('input[type="file"]'))return;const t=e,n=t.files[0]||(t._files||[])[0];if(n&&/image/.test(n.type))return n},ee=(e,t="")=>k(e.replace(new RegExp("^"+t,"g"),"")),te=e=>{if(e==="true"||e==="false")return e==="true";if(!isNaN(e))return parseFloat(e);if(/[0-9]+\/[0-9]+/.test(e)){const[t,n]=e.split("/").map(s=>s.trim()).map(parseFloat);return t/n}if(/^\{|\[/.test(e))try{return JSON.parse(e)}catch{}return e},se=e=>Object.values(e).reduce((t,n)=>{const s=ee(n.name);return t[s]=te(n.value),t},{}),ne=(e,t,n)=>{const s=Object.values(n).filter(r=>/^post/.test(r.name)).map(r=>[r.name.replace(/^post-/,""),r.value]);return{url:t||"",dataset:r=>[...s,[e,r.dest,r.dest.name]]}},I=(e,t)=>(Array.from(e.attributes).filter(({value:s})=>s.length&&s.includes("{")).forEach(({name:s,value:i})=>e.setAttribute(s,E(i,t,"{","}"))),e.childNodes.forEach(s=>{s.nodeType===1&&(s=I(s,t)),s.nodeType===3&&(s.textContent=E(s.textContent,t,"{","}"))}),e),T=(e,t)=>e&&e.content.querySelector(`[data-${t}]`),A=e=>e.querySelector("template"),O=e=>{const t=A(e),n=T(t,"empty"),s=T(t,"load"),i=T(t,"process");return{empty:n,load:s,process:i}},g=(e,t)=>!!O(e)[t],re=(e,t)=>e.querySelector(`[data-${t}]`),f=(e,t,n)=>{const s=O(e);if(Object.keys(s).map(r=>re(e,r)).filter(Boolean).forEach(r=>r.remove()),!s[t])return!1;let i=s[t].cloneNode(!0);return n&&(i=I(i,n)),e.appendChild(i),e.querySelector("[data-drop]")&&K(i,{bubbles:!0}),!0},m=e=>e.querySelector('input[type="file"]'),y=e=>e.querySelector('input[type="hidden"]'),w=e=>{const t=d(e,"src");if(t!=null)return t},P=e=>e.currentState,v=(e,t)=>{e.currentState=t},j=e=>d(e,"store"),F=(e,t,n)=>{const s=A(e)||document.createElement("template");s.innerHTML=s.innerHTML+E(t,n,"{{","}}"),s.parentNode||e.appendChild(s)},ie=(e,t,n)=>{if(!t)return;const s=m(e);if(!s)return;const i={...window[$],...window[e.id],...se(e.attributes)},r=(o,l)=>{s.hidden=!0;const a=y(e);a.value=l.responseText,f(e,"process",{response:l.responseText,filename:o.name,url:URL.createObjectURL(o)})},c=o=>{f(e,"process",{filename:o.name,url:URL.createObjectURL(o)})&&(m(e).hidden=!0)},u=o=>{if(!o){v(globalThis,void 0),h(s);return}const{dest:l,store:a}=o;v(e,o),a?r(l,a):(C(s,l),c(l))},p=()=>{h(s)};Q(t,{editor:i,eventTarget:e,imageState:n,store:i.store&&ne(y(e).name,i.store,e.attributes)}).then(u).catch(p)};function S(){const e=j(this),t=w(this),n={success:d(this,"input-store-success")||'"{filename}" uploaded successfully',reset:d(this,"input-button-reset")||"&times;",url:t};t&&!g(this,"load")&&F(this,Y,n),e&&!g(this,"process")&&F(this,J,n);let s=m(this),i=y(this);const r=s&&s.name||d(this,"name")||"image";s||(s=L("input",{type:"file"}),z.forEach(c=>{const u=d(this,c);u!==null&&s.setAttribute(c,u)}),this.removeAttribute("name"),this.append(s)),e?(s.removeAttribute("name"),i||(i=L("input",{type:"hidden",name:r}),this.append(i))):s.name=r,!t&&g(this,"empty")&&(f(this,"empty"),s.hidden=!0),t&&g(this,"load")&&(f(this,"load"),s.hidden=!0),(!s.accept||!/image/.test(s.accept))&&(s.accept="image/*"),s.removeAttribute("multiple"),s.addEventListener("change",()=>this.edit()),this.addEventListener("click",c=>{const{target:u}=c,p=["reset","remove","browse","edit"].find(o=>u.dataset[o]==="");p&&this[p]()}),this.addEventListener("dropfiles",c=>{c.stopPropagation();const{detail:u}=c,p=u.resources[0];p&&(C(s,p),this.edit())})}const _=M()&&class extends HTMLElement{constructor(){super(...arguments),this.currentState=void 0}connectedCallback(){if(this.innerHTML)return S.apply(this);let e;const t=new MutationObserver(()=>{e!==null&&(clearTimeout(e),S.apply(this),t.disconnect())});t.observe(this,{childList:!0}),e=setTimeout(()=>{e=null,S.apply(this)},0)}browse(){this.querySelector('input[type="file"]').click()}reset(){if(v(this,void 0),!w(this))return this.remove();h(m(this)),f(this,"load")}remove(){const e=m(this);h(e),v(this,void 0),j(this)&&(y(this).value=""),f(this,"empty")||(e.hidden=!1)}edit(){var n,s;const e=m(this);if(!e)return;const t=((n=P(this))==null?void 0:n.src)||Z(e)||w(this);ie(this,t,(s=P(this))==null?void 0:s.imageState)}};_&&!U(R)&&customElements.define(R,_)})();
